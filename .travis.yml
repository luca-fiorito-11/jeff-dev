language: python

env:
  global:
    - CACHEDIR=mycache
    - UTILS=${CACHEDIR}/PVBV_utils
    - ACEDIR=${CACHEDIR}/ace
    - FC='gfortran-5'
    - PYTHONPATH="openmc:${PYTHONPATH}"

python:
  - "3.6"

cache:
  directories:
    - ${CACHEDIR}

stages:
  - setup
  - ace

jobs:
  include:

    - stage: setup
      name: setup cache directory
      install:
        - rm -rf ${CACHEDIR}
        - mkdir -p ${CACHEDIR} ${ACEDIR}
        - ( cd ${CACHEDIR} && git clone https://github.com/luca-fiorito-11/PVBV_utils.git )
        - ( cd ${CACHEDIR} && git clone https://github.com/luca-fiorito-11/benchmarks.git )
        - bash ${UTILS}/install_openmc.sh
      script: skip


    - stage: ace
      name: get ACE files
      script:
        - curl -o ${ACEDIR}/31-Ga-69g.jeff33.ace https://github.com/luca-fiorito-11/31-Ga-69g/releases/download/v4.0T0/31-Ga-69g.jeff33.ace -k
        - curl -o ${ACEDIR}/31-Ga-79g.jeff33.ace https://github.com/luca-fiorito-11/31-Ga-71g/releases/download/v4.0T0/31-Ga-71g.jeff33.ace -k
        - curl -o ${ACEDIR}/94-Pu-239g.jeff33.ace https://github.com/luca-fiorito-11/94-Pu-239g/releases/download/v4.0T0/94-Pu-239g.jeff33.ace -k
        - curl -o ${ACEDIR}/94-Pu-240g.jeff33.ace https://github.com/luca-fiorito-11/94-Pu-240g/releases/download/v4.0T0/94-Pu-240g.jeff33.ace -k
        - curl -o ${ACEDIR}/94-Pu-241g.jeff33.ace https://github.com/luca-fiorito-11/94-Pu-241g/releases/download/v4.0T0/94-Pu-241g.jeff33.ace -k
